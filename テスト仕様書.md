テスト仕様書全体を確認しました。以下の点で不自然な日本語表現や改善すべき箇所を発見しましたので、修正版を提示します。

## 主な修正点

1. **「確認」の重複表現**: 「〜を確認することを確認」→「〜を確認」に修正
2. **冗長な表現**: 「正常に動作している」を簡潔に
3. **用語の統一**: 「メンティ」「担当者」の表記を一貫
4. **助詞の自然さ**: 「〜に対して」「〜について」などの使い分け
5. **期待結果の表現**: より自然な箇条書きに修正

---

# SES日報自動化ツール テスト仕様書

## 1. ドキュメント情報

### 1.1 目的
本テスト仕様書は、「SES日報自動化ツール」の品質を担保するため、実施すべきテストケースを具体的に定義します。テスト観点定義書に基づき、特に「事故が起きないこと」を最優先として、実装後の検証項目を明確化します。

---

### 1.2 対象範囲
- メンティの日報入力（Googleフォーム）
- 自動集約処理（GAS）
- 集約用スプレッドシート
- 下書き生成
- 確認フロー

※ クライアントへの実際の送信操作は対象外

### 1.3 テスト環境
- Googleフォーム（本番環境または検証用コピー）
- 個人用スプレッドシート（検証用）
- 集約用スプレッドシート（検証用）
- Google Apps Script

### 1.4 前提条件
- テスト実施前に、検証用のフォーム・スプレッドシートを用意すること
- テストデータは本番データと明確に区別できるよう、日付や案件名に「TEST」などの識別子を含めること
- 各テストケース実施前に、スプレッドシートの状態（チェックボックスの状態等）を記録すること

---

## 2. テストケース一覧

### 2.1 メンティ日報入力に関するテスト

#### TC-001: 正常な日報入力

**目的**
全ての必須項目を正しく入力した場合、データが個人用スプレッドシートに正常に保存されることを確認

**前提条件**
Googleフォームが正常に動作している

**テスト手順**
1. Googleフォームを開く
2. 全ての項目を正常値で入力（日付、案件名、作業内容、作業時間、GitHubコミット、次回作業日、課題）
3. 送信ボタンをクリック

**期待結果**
- フォーム送信が成功する
- 個人用スプレッドシートに新しい行が追加される
- 入力した全ての値が正しく保存されている
- チェックボックス列は「未チェック（空欄）」状態



#### TC-002: 必須項目未入力時の制御

**目的**
必須項目（日付、案件名、作業内容等）が未入力の場合、フォーム送信がブロックされることを確認

**前提条件**
Googleフォームで必須設定が有効

**テスト手順**
1. Googleフォームを開く
2. 必須項目のいずれかを空欄のまま送信を試みる
3. 各必須項目について個別に確認

**期待結果**
- エラーメッセージが表示される
- 「この質問は必須です」等の警告が表示される
- データは送信されない



#### TC-003: 事前入力URLによる案件名自動入力

**目的**
管理者が発行した「案件名入力済みURL」から開いた場合、案件名が自動入力されることを確認

**前提条件**
案件名が事前入力されたフォームURLが用意されている

**テスト手順**
1. 事前入力URLをブラウザで開く
2. 案件名フィールドの状態を確認
3. その他の項目を入力して送信

**期待結果**
- 案件名フィールドに指定された案件名が入力されている
- メンティが案件名を変更せずに送信できる
- 個人用スプレッドシートに正しい案件名で保存される



### 2.2 自動集約処理に関するテスト

#### TC-004: 未処理データの正常な集約

**目的**
チェックボックスが未チェックの正常なデータが、集約用スプレッドシートに正しく転記されることを確認

**前提条件**
個人用スプレッドシートに「未チェック」かつ「日付入力済み」のデータが1件以上存在

**テスト手順**
1. 個人用スプレッドシートの状態を記録（未処理件数、各行の内容）
2. GASの集約処理を手動実行
3. 集約用スプレッドシートを確認
4. 個人用スプレッドシートのチェックボックス状態を確認

**期待結果**
- 集約用スプレッドシートに下書きが生成される
- 下書き内容が指定フォーマットに従っている
- 個人用スプレッドシートの該当行チェックボックスが「ON」になる
- エラーログが出力されない



#### TC-005: 二重集約の防止（冪等性確認）【最重要】

**目的**
同じデータに対して集約処理を複数回実行しても、データが重複しないことを確認

**前提条件**
個人用スプレッドシートに未処理データが1件存在

**テスト手順**
1. 集約処理を1回目実行
2. 集約用スプレッドシートの行数を記録
3. 何も変更せずに集約処理を2回目実行
4. 集約用スプレッドシートの行数を再確認
5. さらに3回目を実行して確認

**期待結果**
- 1回目実行後、集約用スプレッドシートに1件追加される
- 2回目・3回目実行後も行数は変わらない
- 個人用スプレッドシートのチェックボックスは「ON」のまま
- エラーや警告が発生しない



#### TC-006: 複数メンティデータの同時集約

**目的**
複数メンティ（または複数スプレッドシート）のデータが同時に処理された場合も正常に動作することを確認

**前提条件**
2人以上のメンティの個人用スプレッドシートに未処理データが存在

**テスト手順**
1. メンティA、Bそれぞれの個人用スプレッドシートに未処理データを1件ずつ用意
2. 集約処理を実行
3. 集約用スプレッドシートを確認

**期待結果**
- 両メンティのデータが集約用スプレッドシートに追加される
- それぞれのデータが混在・上書きされていない
- 各メンティの個人用スプレッドシートでチェックボックスが「ON」になる



#### TC-007: 処理済みデータの除外

**目的**
チェックボックスが「ON（処理済み）」のデータは、再度集約されないことを確認

**前提条件**
個人用スプレッドシートに「チェック済み」のデータが存在

**テスト手順**
1. 個人用スプレッドシートで任意の行のチェックボックスを手動で「ON」にする
2. 集約処理を実行
3. 集約用スプレッドシートを確認

**期待結果**
- チェック済みデータは集約用スプレッドシートに追加されない
- 未チェックのデータのみが処理される



#### TC-008: 過去日付データの処理確認

**目的**
過去日付のデータに対する処理挙動が仕様通りであることを確認

**前提条件**
個人用スプレッドシートに「1週間前の日付」で「未チェック」のデータが存在

**テスト手順**
1. 過去日付の未チェックデータを用意
2. 集約処理を実行
3. 集約用スプレッドシートを確認

**期待結果**
- 日付による判定がある場合、古いデータは処理されない
- または、チェックボックス状態のみで判定される場合、処理される（仕様次第で判定）



#### TC-009: 手動実行メニューの動作確認

**目的**
担当者が任意のタイミングで集約処理を手動実行できることを確認

**前提条件**
GASに手動実行メニューが実装されている

**テスト手順**
1. スプレッドシートのメニューバーから手動実行メニューを選択
2. 集約処理が実行されることを確認
3. 処理完了後の状態を確認

**期待結果**
- メニューから集約処理が正常に実行される
- 定時実行と同じ結果が得られる
- エラーが発生しない



### 2.3 異常系・例外処理に関するテスト

#### TC-010: 日付未入力データの除外とエラー記録

**目的**
日付が空欄のデータは集約されず、エラー情報が記録されることを確認

**前提条件**
個人用スプレッドシートに「日付が空欄」で「未チェック」のデータが存在

**テスト手順**
1. 日付列を手動で削除したテストデータを用意
2. 集約処理を実行
3. 集約用スプレッドシートにエラー記録があるか確認
4. 個人用スプレッドシートのチェック状態を確認

**期待結果**
- 該当データは集約用スプレッドシートに正常データとして追加されない
- 集約用スプレッドシートに「データ不備あり（日付なし）」などのエラー情報が記録される
- 個人用スプレッドシートのチェックボックスは「OFF」のまま（不備修正後に再処理可能）



#### TC-011: 必須項目欠損データの処理

**目的**
作業内容など必須項目が欠けているデータの処理が想定通りであることを確認

**前提条件**
個人用スプレッドシートに「作業内容が空欄」のデータが存在（手動操作による発生を想定）

**テスト手順**
1. スプレッドシート上で作業内容列を手動削除
2. 集約処理を実行
3. 動作を確認

**期待結果**
- システムが停止しない
- エラー情報が記録される、または空欄のまま下書きが生成される（仕様次第）
- 担当者が不備に気づける状態になっている



#### TC-012: 処理中断時の復旧確認【重要】

**目的**
GAS実行中にエラーが発生した場合でも、データの整合性が保たれることを確認

**前提条件**
複数の未処理データが存在

**テスト手順**
1. 3件の未処理データを用意
2. GASコード内に意図的にエラーを混入させる、または実行時間制限により強制停止
3. 個人用スプレッドシートの状態を確認
4. 正常なコードで再実行

**期待結果**
- 処理途中で停止しても、チェック済みのデータは重複処理されない
- 未チェックのデータは次回実行時に正常処理される
- 中途半端なデータが集約用スプレッドシートに残らない



#### TC-013: 空文字・特殊文字の混入

**目的**
想定外の空文字、特殊文字、改行等が含まれていても、システムが停止しないことを確認

**前提条件**
テストデータに空文字や特殊文字を含むデータを手動作成

**テスト手順**
1. 課題欄に空文字「""」、改行、タブ、特殊文字等を設定
2. 集約処理を実行
3. 下書き生成を確認

**期待結果**
- エラーでシステムが停止しない
- 空欄として扱われるか、デフォルト値（「なし」等）で補完される
- 特殊文字が適切にエスケープまたは表示される



#### TC-014: 処理実行中のフォーム送信（競合）

**目的**
集約処理実行中にメンティがフォーム送信を行った場合、データの整合性が保たれることを確認

**前提条件**
集約処理が実行中

**テスト手順**
1. 集約処理を実行開始
2. 処理実行中にメンティが新規日報を送信
3. 処理完了後、両データの状態を確認

**期待結果**
- 処理実行前のデータは正常に集約される
- 処理実行中に送信されたデータは未チェックのまま残る（次回処理対象）
- データの破損や欠落が発生しない



#### TC-015: スプレッドシート構造変化への耐性

**目的**
個人用スプレッドシートの列順変更や行削除が行われても、システムが適切に動作することを確認

**前提条件**
個人用スプレッドシートにテストデータが存在

**テスト手順**
1. 列の順序を変更する
2. 任意の行を削除する
3. 集約処理を実行

**期待結果**
- システムがエラーで停止しない（列名で判定している場合）
- または、適切なエラーメッセージが表示される（列位置で判定している場合）
- 正常なデータは処理される



### 2.4 状態管理に関するテスト

#### TC-016: チェックボックス状態の正確性

**目的**
未処理・処理済・送信済の状態が正しく判別できることを確認

**前提条件**
各状態のサンプルデータが存在

**テスト手順**
1. 未処理状態：チェックボックス「OFF」のデータを確認
2. 処理実行後：チェックボックスが「ON」に変わることを確認
3. 手動でチェックを外した場合の挙動を確認

**期待結果**
- 各状態が視覚的に区別できる
- システムが状態を正しく認識して処理する



#### TC-017: 手動チェック変更後の再処理

**目的**
担当者が誤ってチェックボックスを変更した場合の挙動を確認

**前提条件**
処理済み（チェック済み）のデータが存在

**テスト手順**
1. 処理済みデータのチェックを手動で「OFF」にする
2. 集約処理を実行
3. 動作を確認

**期待結果**
- チェックを外したデータが再度処理される、または
- 日付等で判定して処理されない（仕様次第）
- いずれの場合もシステムが停止しない



### 2.5 下書き生成に関するテスト

#### TC-018: 下書きフォーマットの正確性

**目的**
生成される下書きが、指定されたフォーマットに従っていることを確認

**前提条件**
正常な日報データが1件存在

**テスト手順**
1. 集約処理を実行
2. 集約用スプレッドシートの下書き内容を確認
3. フォーマット定義（要件定義書3.5節）と照合

**期待結果**
- 件名が「【作業報告】[氏名]（[日付]分）」形式
- 各セクション（勤務実績、作業内容、進捗状況、課題・懸念事項、次回の予定）が含まれる
- メンティ入力値が正しく埋め込まれている
- 不要な空白や改行がない



#### TC-019: 日付と曜日の自動計算

**目的**
下書きに含まれる日付と曜日が正しく計算・表示されることを確認

**前提条件**
正常な日報データが1件存在

**テスト手順**
1. 特定の日付（例：2025/01/20）で日報を作成
2. 集約処理を実行
3. 下書きの「勤務実績」セクションを確認

**期待結果**
- 日付が正しく表示される（例：2025/01/20）
- 曜日が正しく表示される（例：月曜日）
- 日付と曜日の対応が正確



#### TC-020: 課題なし時の下書き表示

**目的**
課題欄が「なし」の場合でも、下書きが正常に生成されることを確認

**前提条件**
課題欄に「なし」と入力されたデータが存在

**テスト手順**
1. 課題に「なし」を入力して日報送信
2. 集約処理を実行
3. 下書きを確認

**期待結果**
- 課題セクションに「なし」が表示される、または
- 課題セクションが省略される（仕様次第）



#### TC-021: 複数データの下書き生成

**目的**
同一メンティの複数日分データが同時に処理された場合の下書き生成を確認

**前提条件**
個人用スプレッドシートに未処理データが3件存在

**テスト手順**
1. 異なる日付で3件の日報を作成
2. 集約処理を実行
3. 集約用スプレッドシートを確認

**期待結果**
- 3件それぞれの下書きが生成される
- 日付順に並んでいる（仕様次第）
- データの混在がない



#### TC-022: 空データ時の下書き非生成

**目的**
未処理データが存在しない場合、下書きが生成されないことを確認

**前提条件**
個人用スプレッドシートに未処理データが0件

**テスト手順**
1. 全てのデータを処理済み状態にする
2. 集約処理を実行
3. 集約用スプレッドシートを確認

**期待結果**
- 新しい下書きが追加されない
- エラーが発生しない
- 既存の下書きが削除・上書きされない



### 2.6 確認フローに関するテスト

#### TC-023: 下書き作成の可視化

**目的**
下書きが作成されたことに担当者が気づける仕組みがあることを確認

**前提条件**
集約処理が実行され、下書きが生成されている

**テスト手順**
1. 集約用スプレッドシートを開く
2. 新規下書きの識別方法を確認（色分け、フラグ、日付など）

**期待結果**
- 未確認の下書きが視覚的に判別できる
- 送信済みチェックボックスが「OFF」状態



#### TC-024: 送信済みチェック機能

**目的**
担当者が送信後にチェックボックスをONにし、送信済み・未送信が区別できることを確認

**前提条件**
集約用スプレッドシートに下書きが存在

**テスト手順**
1. 下書きを確認
2. 送信済みチェックボックスを「ON」にする
3. 見た目の変化を確認

**期待結果**
- チェックボックスが正常に動作する
- チェック済み行が視覚的に区別できる（色変更等があればなお良い）



#### TC-025: 担当者による下書き編集

**目的**
集約用スプレッドシートで下書きを編集しても、元データ（個人用スプレッドシート）に影響しないことを確認

**前提条件**
集約用スプレッドシートに下書きが生成されている

**テスト手順**
1. 集約用スプレッドシートの下書き内容を編集
2. 個人用スプレッドシートの元データを確認

**期待結果**
- 集約用スプレッドシートの内容のみが変更される
- 個人用スプレッドシートのデータは変更されない



### 2.7 統合テスト

#### TC-026: エンドツーエンドの正常フロー【重要】

**目的**
メンティの入力から担当者の送信完了まで、一連のフローが正常に動作することを確認

**前提条件**
すべてのコンポーネントが設定済み

**テスト手順**
1. メンティがGoogleフォームから日報を入力・送信
2. GASで集約処理を実行（手動または自動）
3. 担当者が集約用スプレッドシートで下書きを確認
4. 必要に応じて編集
5. 送信済みチェックをON

**期待結果**
- 各ステップが正常に完了する
- データの欠損・重複がない
- 担当者が安心して確認・送信できる状態になっている



#### TC-027: 複数メンティ・複数日の複合シナリオテスト【重要】

**目的**
実運用を想定した複合的なシナリオで動作を確認

**前提条件**
複数メンティのフォーム・スプレッドシートが用意されている

**テスト手順**
1. メンティA：2日分の日報を入力
2. メンティB：1日分の日報を入力
3. 集約処理を実行
4. メンティA：追加で1日分を入力
5. 再度集約処理を実行
6. 各下書きを確認

**期待結果**
- 合計4件の下書きが正しく生成される
- メンティごとに区別されている
- データの混在・重複がない
- 2回目の実行でも1回目

